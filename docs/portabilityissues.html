<!DOCTYPE html><html><head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.7.28">
  <title>Portability Issues</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.7">
  <link rel="HOME" title="Advanced Bash-Scripting Guide" href="index.html">
  <link rel="UP" title="Miscellany" href="miscellany.html">
  <link rel="PREVIOUS" title="Security Issues" href="securityissues.html">
  <link rel="NEXT" title="Shell Scripting Under Windows" href="winscript.html">
<link rel="stylesheet" href="styles/custom.css"><link rel="stylesheet" href="styles/atom-one-dark.css"></head>
<body class="SECT1" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <th colspan="3" align="center">Advanced Bash-Scripting Guide:</th>
      </tr>
      <tr>
        <td width="10%" align="left" valign="bottom"><a href="securityissues.html" accesskey="P">Prev</a></td>
        <td width="80%" align="center" valign="bottom">Chapter 36. Miscellany</td>
        <td width="10%" align="right" valign="bottom"><a href="winscript.html" accesskey="N">Next</a></td>
      </tr>
    </tbody></table>
    <hr align="left" width="100%">
  </div>
  <div class="SECT1">
    <h1 class="SECT1"><a name="PORTABILITYISSUES" id="PORTABILITYISSUES"></a>36.9. Portability Issues</h1>
    <table border="0" width="100%" cellspacing="0" cellpadding="0" class="EPIGRAPH">
      <tbody><tr>
        <td width="45%">&nbsp;</td>
        <td width="45%" align="left" valign="top">
          <p><i>It is easier to port a shell than a shell script.</i></p>
          <p><i>--Larry Wall</i></p>
        </td>
      </tr>
    </tbody></table>
    <p>This book deals specifically with Bash scripting on a GNU/Linux system. All the same, users of <b class="COMMAND">sh</b> and <b class="COMMAND">ksh</b> will find much of value here.</p>
    <p><a name="POSIX3REF" id="POSIX3REF"></a>As it happens, many of the various shells and scripting languages seem to be converging toward the <a href="sha-bang.html#POSIX2REF">POSIX</a> 1003.2 standard. Invoking Bash with the <tt class="OPTION">--posix</tt> option or inserting a <b class="COMMAND">set -o posix</b> at the head of a script causes Bash to conform very closely to this standard. Another alternative is to use a <i class="FIRSTTERM">#!/bin/sh</i> <a href="sha-bang.html#SHABANGREF">sha-bang header</a> in the script, rather than <i class="FIRSTTERM">#!/bin/bash</i>. <a name="AEN20799" href="#FTN.AEN20799" id="AEN20799"><span class="footnote">[1]</span></a> Note that <tt class="FILENAME">/bin/sh</tt> is a <a href="basic.html#LINKREF">link</a> to <tt class="FILENAME">/bin/bash</tt> in Linux and certain other flavors of UNIX, and a script invoked this way disables extended Bash functionality.</p>
    <p>Most Bash scripts will run as-is under <b class="COMMAND">ksh</b>, and vice-versa, since Chet Ramey has been busily porting <b class="COMMAND">ksh</b> features to the latest versions of Bash.</p>
    <p>On a commercial UNIX machine, scripts using GNU-specific features of standard commands may not work. This has become less of a problem in the last few years, as the GNU utilities have pretty much displaced their proprietary counterparts even on <span class="QUOTE">"big-iron"</span> UNIX. <a href="http://linux.oreillynet.com/pub/a/linux/2002/02/28/caldera.html" target="_top">Caldera's release of the source</a> to many of the original UNIX utilities has accelerated the trend.</p>
    <p><a name="BASHCOMPAT" id="BASHCOMPAT"></a></p>
    <p>Bash has certain features that the traditional <a href="why-shell.html#BASHDEF">Bourne shell</a> lacks. Among these are:</p>
    <ul>
      <li>
        <p>Certain extended <a href="options.html#INVOCATIONOPTIONSREF">invocation options</a></p>
      </li>
      <li>
        <p><a href="commandsub.html#COMMANDSUBREF">Command substitution</a> using <b class="COMMAND">$( )</b> notation</p>
      </li>
      <li>
        <p><a href="bashver3.html#BRACEEXPREF3">Brace expansion</a></p>
      </li>
      <li>
        <p>Certain <a href="arrays.html#ARRAYREF">array</a> operations, and <a href="bashver4.html#ASSOCARR">associative arrays</a></p>
      </li>
      <li>
        <p>The <a href="testconstructs.html#DBLBRACKETS">double brackets</a> extended test construct</p>
      </li>
      <li>
        <p>The <a href="dblparens.html#DBLPARENSREF">double-parentheses</a> arithmetic-evaluation construct</p>
      </li>
      <li>
        <p>Certain <a href="string-manipulation.html#STRINGMANIP">string manipulation</a> operations</p>
      </li>
      <li>
        <p><a href="process-sub.html#PROCESSSUBREF">Process substitution</a></p>
      </li>
      <li>
        <p>A Regular Expression <a href="bashver3.html#REGEXMATCHREF">matching operator</a></p>
      </li>
      <li>
        <p>Bash-specific <a href="internal.html#BUILTINREF">builtins</a></p>
      </li>
      <li>
        <p><a href="bashver4.html#COPROCREF">Coprocesses</a></p>
      </li>
    </ul>
    <p>See the <a href="ftp://ftp.cwru.edu/pub/bash/FAQ" target="_top">Bash F.A.Q.</a> for a complete listing.</p>
    <div class="SECT2">
      <h2 class="SECT2"><a name="AEN20853" id="AEN20853"></a>36.9.1. A Test Suite</h2>
      <p><a name="TESTSUITE0" id="TESTSUITE0"></a>Let us illustrate some of the incompatibilities between Bash and the classic Bourne shell. Download and install the <a href="http://freshmeat.net/projects/bournesh" target="_top"><span class="QUOTE">"Heirloom Bourne Shell"</span></a> and run the following script, first using Bash, then the classic <i class="FIRSTTERM">sh</i>.</p>
      <div class="EXAMPLE">
        <a name="TESTSUITE" id="TESTSUITE"></a>
        <p><b>Example 36-23. Test Suite</b></p>
        <table border="0" bgcolor="#E0E0E0" width="100%">
          <tbody><tr>
            <td>
              <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># test-suite.sh</span>
<span class="hljs-comment"># A partial Bash compatibility test suite.</span>
<span class="hljs-comment"># Run this on your version of Bash, or some other shell.</span>

default_option=FAIL         <span class="hljs-comment"># Tests below will fail unless . . .</span>

<span class="hljs-built_in">echo</span>
<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"Testing "</span>
sleep 1; <span class="hljs-built_in">echo</span> -n <span class="hljs-string">". "</span>
sleep 1; <span class="hljs-built_in">echo</span> -n <span class="hljs-string">". "</span>
sleep 1; <span class="hljs-built_in">echo</span> <span class="hljs-string">". "</span>
<span class="hljs-built_in">echo</span>

<span class="hljs-comment"># Double brackets</span>
String=<span class="hljs-string">"Double brackets supported?"</span>
<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"Double brackets test: "</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$String</span>"</span> = <span class="hljs-string">"Double brackets supported?"</span> ]]
<span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"PASS"</span>
<span class="hljs-keyword">else</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"FAIL"</span>
<span class="hljs-keyword">fi</span>


<span class="hljs-comment"># Double brackets and regex matching</span>
String=<span class="hljs-string">"Regex matching supported?"</span>
<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"Regex matching: "</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$String</span>"</span> =~ R.....matching* ]]
<span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"PASS"</span>
<span class="hljs-keyword">else</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"FAIL"</span>
<span class="hljs-keyword">fi</span>


<span class="hljs-comment"># Arrays</span>
test_arr=<span class="hljs-variable">$default_option</span>     <span class="hljs-comment"># FAIL</span>
Array=( If supports arrays will <span class="hljs-built_in">print</span> PASS )
test_arr=<span class="hljs-variable">${Array[5]}</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Array test: <span class="hljs-variable">$test_arr</span>"</span>


<span class="hljs-comment"># Command Substitution</span>
<span class="hljs-function"><span class="hljs-title">csub_test</span></span> ()
{
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"PASS"</span>
}

test_csub=<span class="hljs-variable">$default_option</span>    <span class="hljs-comment"># FAIL</span>
test_csub=$(csub_test)
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Command substitution test: <span class="hljs-variable">$test_csub</span>"</span>

<span class="hljs-built_in">echo</span>

<span class="hljs-comment">#  Completing this script is an exercise for the reader.</span>
<span class="hljs-comment">#  Add to the above similar tests for double parentheses,</span>
<span class="hljs-comment">#+ brace expansion, process substitution, etc.</span>

<span class="hljs-built_in">exit</span> $?</pre>
            </td>
          </tr>
        </tbody></table>
      </div>
    </div>
  </div>
  <h3 class="FOOTNOTES">Notes</h3>
  <table border="0" class="FOOTNOTES" width="100%">
    <tbody><tr>
      <td align="left" valign="top" width="5%"><a name="FTN.AEN20799" href="portabilityissues.html#AEN20799" id="FTN.AEN20799"><span class="footnote">[1]</span></a></td>
      <td align="left" valign="top" width="95%">
        <p>Or, better yet, <a href="system.html#ENVV2REF">#!/bin/env sh</a>.</p>
      </td>
    </tr>
  </tbody></table>
  <div class="NAVFOOTER">
    <hr align="left" width="100%">
    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <td width="33%" align="left" valign="top"><a href="securityissues.html" accesskey="P">Prev</a></td>
        <td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>
        <td width="33%" align="right" valign="top"><a href="winscript.html" accesskey="N">Next</a></td>
      </tr>
      <tr>
        <td width="33%" align="left" valign="top">Security Issues</td>
        <td width="34%" align="center" valign="top"><a href="miscellany.html" accesskey="U">Up</a></td>
        <td width="33%" align="right" valign="top">Shell Scripting Under Windows</td>
      </tr>
    </tbody></table>
  </div>


</body></html>
