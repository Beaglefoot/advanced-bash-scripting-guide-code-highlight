<!DOCTYPE html><html><head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.7.28">
  <title>Bash, version 3</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.7">
  <link rel="HOME" title="Advanced Bash-Scripting Guide" href="index.html">
  <link rel="UP" title="Bash, versions 2, 3, and 4" href="bash2.html">
  <link rel="PREVIOUS" title="Bash, version 2" href="bashver2.html">
  <link rel="NEXT" title="Bash, version 4" href="bashver4.html">
<link rel="stylesheet" href="styles/custom.css"><link rel="stylesheet" href="styles/atom-one-dark.css"></head>
<body class="SECT1" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <th colspan="3" align="center">Advanced Bash-Scripting Guide:</th>
      </tr>
      <tr>
        <td width="10%" align="left" valign="bottom"><a href="bashver2.html" accesskey="P">Prev</a></td>
        <td width="80%" align="center" valign="bottom">Chapter 37. Bash, versions 2, 3, and 4</td>
        <td width="10%" align="right" valign="bottom"><a href="bashver4.html" accesskey="N">Next</a></td>
      </tr>
    </tbody></table>
    <hr align="left" width="100%">
  </div>
  <div class="SECT1">
    <h1 class="SECT1"><a name="BASHVER3" id="BASHVER3"></a>37.2. Bash, version 3</h1>
    <p><a name="BASH3REF" id="BASH3REF"></a></p>
    <p>On July 27, 2004, Chet Ramey released version 3 of Bash. This update fixed quite a number of bugs and added new features.</p>
    <p>Some of the more important added features:</p>
    <ul>
      <li>
        <p><a name="BRACEEXPREF3" id="BRACEEXPREF3"></a></p>
        <p>A new, more generalized <b class="COMMAND">{a..z}</b> <a href="special-chars.html#BRACEEXPREF">brace expansion</a> operator.</p>
        <table border="0" bgcolor="#E0E0E0" width="90%">
          <tbody><tr>
            <td>
              <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> {1..10}
<span class="hljs-comment">#  Simpler and more straightforward than</span>
<span class="hljs-comment">#+ for i in $(seq 10)</span>
<span class="hljs-keyword">do</span>
  <span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$i</span> "</span>
<span class="hljs-keyword">done</span>

<span class="hljs-built_in">echo</span>

<span class="hljs-comment"># 1 2 3 4 5 6 7 8 9 10</span>



<span class="hljs-comment"># Or just . . .</span>

<span class="hljs-built_in">echo</span> {a..z}    <span class="hljs-comment">#  a b c d e f g h i j k l m n o p q r s t u v w x y z</span>
<span class="hljs-built_in">echo</span> {e..m}    <span class="hljs-comment">#  e f g h i j k l m</span>
<span class="hljs-built_in">echo</span> {z..a}    <span class="hljs-comment">#  z y x w v u t s r q p o n m l k j i h g f e d c b a</span>
               <span class="hljs-comment">#  Works backwards, too.</span>
<span class="hljs-built_in">echo</span> {25..30}  <span class="hljs-comment">#  25 26 27 28 29 30</span>
<span class="hljs-built_in">echo</span> {3..-2}   <span class="hljs-comment">#  3 2 1 0 -1 -2</span>
<span class="hljs-built_in">echo</span> {X..d}    <span class="hljs-comment">#  X Y Z [  ] ^ _ ` a b c d</span>
               <span class="hljs-comment">#  Shows (some of) the ASCII characters between Z and a,</span>
               <span class="hljs-comment">#+ but don't rely on this type of behavior because . . .</span>
<span class="hljs-built_in">echo</span> {]..a}    <span class="hljs-comment">#  {]..a}</span>
               <span class="hljs-comment">#  Why?</span>


<span class="hljs-comment"># You can tack on prefixes and suffixes.</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Number #"</span>{1..4}, <span class="hljs-string">"..."</span>
     <span class="hljs-comment"># Number #1, Number #2, Number #3, Number #4, ...</span>


<span class="hljs-comment"># You can concatenate brace-expansion sets.</span>
<span class="hljs-built_in">echo</span> {1..3}{x..z}<span class="hljs-string">" +"</span> <span class="hljs-string">"..."</span>
     <span class="hljs-comment"># 1x + 1y + 1z + 2x + 2y + 2z + 3x + 3y + 3z + ...</span>
     <span class="hljs-comment"># Generates an algebraic expression.</span>
     <span class="hljs-comment"># This could be used to find permutations.</span>

<span class="hljs-comment"># You can nest brace-expansion sets.</span>
<span class="hljs-built_in">echo</span> {{a..c},{1..3}}
     <span class="hljs-comment"># a b c 1 2 3</span>
     <span class="hljs-comment"># The "comma operator" splices together strings.</span>

<span class="hljs-comment"># ########## ######### ############ ########### ######### ###############</span>
<span class="hljs-comment"># Unfortunately, brace expansion does not lend itself to parameterization.</span>
var1=1
var2=5
<span class="hljs-built_in">echo</span> {<span class="hljs-variable">$var1</span>..<span class="hljs-variable">$var2</span>}   <span class="hljs-comment"># {1..5}</span>


<span class="hljs-comment"># Yet, as Emiliano G. points out, using "eval" overcomes this limitation.</span>

start=0
end=10
<span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">eval</span> <span class="hljs-built_in">echo</span> {<span class="hljs-variable">$start</span>..<span class="hljs-variable">$end</span>})
<span class="hljs-keyword">do</span>
  <span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$index</span> "</span>   <span class="hljs-comment"># 0 1 2 3 4 5 6 7 8 9 10 </span>
<span class="hljs-keyword">done</span>

<span class="hljs-built_in">echo</span></pre>
            </td>
          </tr>
        </tbody></table>
      </li>
      <li>
        <p>The <b class="COMMAND">${!array[@]}</b> operator, which expands to all the indices of a given <a href="arrays.html#ARRAYREF">array</a>.</p>
        <table border="0" bgcolor="#E0E0E0" width="90%">
          <tbody><tr>
            <td>
              <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

Array=(element-zero element-one element-two element-three)

<span class="hljs-built_in">echo</span> <span class="hljs-variable">${Array[0]}</span>   <span class="hljs-comment"># element-zero</span>
                   <span class="hljs-comment"># First element of array.</span>

<span class="hljs-built_in">echo</span> <span class="hljs-variable">${!Array[@]}</span>  <span class="hljs-comment"># 0 1 2 3</span>
                   <span class="hljs-comment"># All the indices of Array.</span>

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!Array[@]}</span>
<span class="hljs-keyword">do</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-variable">${Array[i]}</span> <span class="hljs-comment"># element-zero</span>
                   <span class="hljs-comment"># element-one</span>
                   <span class="hljs-comment"># element-two</span>
                   <span class="hljs-comment"># element-three</span>
                   <span class="hljs-comment">#</span>
                   <span class="hljs-comment"># All the elements in Array.</span>
<span class="hljs-keyword">done</span></pre>
            </td>
          </tr>
        </tbody></table>
      </li>
      <li>
        <p><a name="REGEXMATCHREF" id="REGEXMATCHREF"></a></p>
        <p>The <b class="COMMAND">=~</b> <a href="regexp.html#REGEXREF">Regular Expression</a> matching operator within a <a href="testconstructs.html#DBLBRACKETS">double brackets</a> test expression. (Perl has a similar operator.)</p>
        <table border="0" bgcolor="#E0E0E0" width="90%">
          <tbody><tr>
            <td>
              <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

variable=<span class="hljs-string">"This is a fine mess."</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span>

<span class="hljs-comment"># Regex matching with =~ operator within [[ double brackets ]].</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span> =~ T.........fin*es* ]]
<span class="hljs-comment"># <span class="hljs-doctag">NOTE:</span> As of version 3.2 of Bash, expression to match no longer quoted.</span>
<span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"match found"</span>
      <span class="hljs-comment"># match found</span>
<span class="hljs-keyword">fi</span></pre>
            </td>
          </tr>
        </tbody></table>
        <p>Or, more usefully:</p>
        <table border="0" bgcolor="#E0E0E0" width="90%">
          <tbody><tr>
            <td>
              <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

input=<span class="hljs-variable">$1</span>


<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$input</span>"</span> =~ <span class="hljs-string">"[0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]"</span> ]]
<span class="hljs-comment">#                 ^ <span class="hljs-doctag">NOTE:</span> Quoting not necessary, as of version 3.2 of Bash.</span>
<span class="hljs-comment"># NNN-NN-NNNN (where each N is a digit).</span>
<span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Social Security number."</span>
  <span class="hljs-comment"># Process SSN.</span>
<span class="hljs-keyword">else</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Not a Social Security number!"</span>
  <span class="hljs-comment"># Or, ask for corrected input.</span>
<span class="hljs-keyword">fi</span></pre>
            </td>
          </tr>
        </tbody></table>
        <p>For additional examples of using the <b class="COMMAND">=~</b> operator, see <a href="contributed-scripts.html#WHX">Example A-29</a>, <a href="x17837.html#MAILBOXGREP">Example 19-14</a>, <a href="contributed-scripts.html#FINDSPLIT">Example A-35</a>, and <a href="contributed-scripts.html#TOHTML">Example A-24</a>.</p>
      </li>
      <li>
        <p><a name="PIPEFAILREF" id="PIPEFAILREF"></a></p>
        <p>The new <tt class="OPTION">set -o pipefail</tt> option is useful for debugging <a href="special-chars.html#PIPEREF">pipes</a>. If this option is set, then the <a href="exit-status.html#EXITSTATUSREF">exit status</a> of a pipe is the exit status of the last command in the pipe to <em>fail</em> (return a non-zero value), rather than the actual final command in the pipe.</p>
        <p>See <a href="communications.html#FC4UPD">Example 16-43</a>.</p>
      </li>
    </ul>
    <div class="CAUTION">
      <table class="CAUTION" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/caution.gif" hspace="5" alt="Caution"></td>
          <td align="left" valign="top">
            <p>The update to version 3 of Bash breaks a few scripts that worked under earlier versions. <em>Test critical legacy scripts to make sure they still work!</em></p>
            <p>As it happens, a couple of the scripts in the <em>Advanced Bash Scripting Guide</em> had to be fixed up (see <a href="internalvariables.html#TOUT">Example 9-4</a>, for instance).</p>
          </td>
        </tr>
      </tbody></table>
    </div>
    <div class="SECT2">
      <h2 class="SECT2"><a name="AEN20956" id="AEN20956"></a>37.2.1. Bash, version 3.1</h2>
      <p>The version 3.1 update of Bash introduces a number of bugfixes and a few minor changes.</p>
      <ul>
        <li>
          <p>The <span class="TOKEN">+=</span> operator is now permitted in in places where previously only the <span class="TOKEN">=</span> assignment operator was recognized.</p>
          <p><a name="PLUSEQSTR" id="PLUSEQSTR"></a></p>
          <table border="0" bgcolor="#E0E0E0" width="90%">
            <tbody><tr>
              <td>
                <pre class="PROGRAMLISTING hljs">a=1
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span>        <span class="hljs-comment"># 1</span>

a+=5           <span class="hljs-comment"># Won't work under versions of Bash earlier than 3.1.</span>
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span>        <span class="hljs-comment"># 15</span>

a+=Hello
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span>        <span class="hljs-comment"># 15Hello</span></pre>
              </td>
            </tr>
          </tbody></table>
          <p>Here, <span class="TOKEN">+=</span> functions as a <i class="FIRSTTERM">string concatenation</i> operator. Note that its behavior in this particular context is different than within a <a href="internal.html#LETREF">let</a> construct.</p>
          <table border="0" bgcolor="#E0E0E0" width="90%">
            <tbody><tr>
              <td>
                <pre class="PROGRAMLISTING hljs">a=1
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span>        <span class="hljs-comment"># 1</span>

<span class="hljs-built_in">let</span> a+=5       <span class="hljs-comment"># Integer arithmetic, rather than string concatenation.</span>
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span>        <span class="hljs-comment"># 6</span>

<span class="hljs-built_in">let</span> a+=Hello   <span class="hljs-comment"># Doesn't "add" anything to a.</span>
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span>        <span class="hljs-comment"># 6</span></pre>
              </td>
            </tr>
          </tbody></table>
          <p><a name="PATHAPPEND" id="PATHAPPEND"></a>Jeffrey Haemer points out that this concatenation operator can be quite useful. In this instance, we append a directory to the <tt class="VARNAME">$PATH</tt>.</p>
          <p></p>
          <table border="1" bgcolor="#E0E0E0" width="90%" class="no-border">
            <tbody><tr>
              <td>
                <pre class="SCREEN hljs"><span class="hljs-meta">bash$</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span></span>
/usr/bin:/bin:/usr/local/bin:/usr/X11R6/bin/:/usr/games
<span class="hljs-meta">

bash$</span><span class="bash"> PATH+=:/opt/bin</span>
<span class="hljs-meta">
bash$</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span></span>
/usr/bin:/bin:/usr/local/bin:/usr/X11R6/bin/:/usr/games:/opt/bin
      </pre>
              </td>
            </tr>
          </tbody></table>
        </li>
      </ul>
    </div>
    <div class="SECT2">
      <h2 class="SECT2"><a name="AEN20987" id="AEN20987"></a>37.2.2. Bash, version 3.2</h2>
      <p>This is pretty much a bugfix update.</p>
      <ul>
        <li>
          <p>In <a href="parameter-substitution.html#PSGLOB"><i class="FIRSTTERM">global</i> parameter substitutions</a>, the pattern no longer anchors at the start of the string.</p>
        </li>
        <li>
          <p>The <tt class="OPTION">--wordexp</tt> option disables <a href="process-sub.html#PROCESSSUBREF">process substitution</a>.</p>
        </li>
        <li>
          <p>The <b class="COMMAND">=~</b> <a href="bashver3.html#REGEXMATCHREF">Regular Expression match operator</a> no longer requires <a href="quoting.html#QUOTINGREF">quoting</a> of the <i class="FIRSTTERM">pattern</i> within <a href="testconstructs.html#DBLBRACKETS">[[ ... ]]</a>.</p>
          <div class="CAUTION">
            <table class="CAUTION" width="90%" border="0">
              <tbody><tr>
                <td width="25" align="center" valign="top"><img src="images/caution.gif" hspace="5" alt="Caution"></td>
                <td align="left" valign="top">
                  <p>In fact, quoting in this context is <em>not</em> advisable as it may cause <i class="FIRSTTERM">regex</i> evaluation to fail. Chet Ramey states in the <a href="biblio.html#BASHFAQ">Bash FAQ</a> that quoting explicitly disables regex evaluation. See also the <a href="https://bugs.launchpad.net/ubuntu-website/+bug/109931" target="_top">Ubuntu Bug List</a> and <a href="http://en.wikinerds.org/index.php/Bash_syntax_and_semantics" target="_top">Wikinerds on Bash syntax</a>.</p>
                  <p>Setting <em>shopt -s compat31</em> in a script causes reversion to the original behavior.</p>
                </td>
              </tr>
            </tbody></table>
          </div>
        </li>
      </ul>
    </div>
  </div>
  <div class="NAVFOOTER">
    <hr align="left" width="100%">
    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <td width="33%" align="left" valign="top"><a href="bashver2.html" accesskey="P">Prev</a></td>
        <td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>
        <td width="33%" align="right" valign="top"><a href="bashver4.html" accesskey="N">Next</a></td>
      </tr>
      <tr>
        <td width="33%" align="left" valign="top">Bash, version 2</td>
        <td width="34%" align="center" valign="top"><a href="bash2.html" accesskey="U">Up</a></td>
        <td width="33%" align="right" valign="top">Bash, version 4</td>
      </tr>
    </tbody></table>
  </div>


</body></html>
