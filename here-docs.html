<!DOCTYPE html><html><head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.7.28">
  <title>Here Documents</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.7">
  <link rel="HOME" title="Advanced Bash-Scripting Guide" href="index.html">
  <link rel="UP" title="Advanced Topics" href="part5.html">
  <link rel="PREVIOUS" title="Globbing" href="globbingref.html">
  <link rel="NEXT" title="Here Strings" href="x17837.html">
<link rel="stylesheet" href="styles/custom.css"><link rel="stylesheet" href="styles/atom-one-dark.css"><script>
    document.addEventListener('DOMContentLoaded', () => {
      if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark-mode');
      }

      document.getElementById('theme-toggle').addEventListener(
        'click',
        () => document.body.classList.toggle('dark-mode')
      );
    });
  </script></head>
<body class="CHAPTER" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <th colspan="3" align="center">Advanced Bash-Scripting Guide:</th>
      </tr>
      <tr>
        <td width="10%" align="left" valign="bottom"><a href="globbingref.html" accesskey="P">Prev</a></td>
        <td width="80%" align="center" valign="bottom"></td>
        <td width="10%" align="right" valign="bottom"><a href="x17837.html" accesskey="N">Next</a></td>
      </tr>
    </tbody></table>
    <hr align="left" width="100%">
  </div>
  <div class="CHAPTER">
    <h1><a name="HERE-DOCS" id="HERE-DOCS"></a>Chapter 19. Here Documents</h1>
    <table border="0" width="100%" cellspacing="0" cellpadding="0" class="EPIGRAPH">
      <tbody><tr>
        <td width="45%">&nbsp;</td>
        <td width="45%" align="left" valign="top">
          <p><i>Here and now, boys.</i></p>
          <p><i>--Aldous Huxley, Island</i></p>
        </td>
      </tr>
    </tbody></table>
    <p><a name="HEREDOCREF" id="HEREDOCREF"></a></p>
    <p>A <i class="FIRSTTERM">here document</i> is a special-purpose code block. It uses a form of <a href="io-redirection.html#IOREDIRREF">I/O redirection</a> to feed a command list to an interactive program or a command, such as <a href="communications.html#FTPREF">ftp</a>, <a href="basic.html#CATREF">cat</a>, or the <i class="FIRSTTERM">ex</i> text editor.</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs">COMMAND &lt;&lt;InputComesFromHERE
...
...
...
InputComesFromHERE</pre>
        </td>
      </tr>
    </tbody></table>
    <p><a name="LIMITSTRINGREF" id="LIMITSTRINGREF"></a></p>
    <p>A <i class="FIRSTTERM">limit string</i> delineates (frames) the command list. The special symbol <span class="TOKEN">&lt;&lt;</span> precedes the limit string. This has the effect of redirecting the output of a command block into the <tt class="FILENAME">stdin</tt> of the program or command. It is similar to <tt class="USERINPUT"><b>interactive-program &lt; command-file</b></tt>, where <tt class="FILENAME">command-file</tt> contains</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs"><span class="hljs-built_in">command</span> <span class="hljs-comment">#1</span>
<span class="hljs-built_in">command</span> <span class="hljs-comment">#2</span>
...</pre>
        </td>
      </tr>
    </tbody></table>
    <p>The <i class="FIRSTTERM">here document</i> equivalent looks like this:</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs">interactive-program &lt;&lt;LimitString
<span class="hljs-built_in">command</span> <span class="hljs-comment">#1</span>
<span class="hljs-built_in">command</span> <span class="hljs-comment">#2</span>
...
LimitString</pre>
        </td>
      </tr>
    </tbody></table>
    <p>Choose a <i class="FIRSTTERM">limit string</i> sufficiently unusual that it will not occur anywhere in the command list and confuse matters.</p>
    <p>Note that <i class="FIRSTTERM">here documents</i> may sometimes be used to good effect with non-interactive utilities and commands, such as, for example, <a href="system.html#WALLREF">wall</a>.</p>
    <div class="EXAMPLE">
      <a name="EX70" id="EX70"></a>
      <p><b>Example 19-1. <i class="FIRSTTERM">broadcast</i>: Sends message to everyone logged in</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

wall &lt;&lt;zzz23EndOfMessagezzz23
E-mail your noontime orders <span class="hljs-keyword">for</span> pizza to the system administrator.
    (Add an extra dollar <span class="hljs-keyword">for</span> anchovy or mushroom topping.)
<span class="hljs-comment"># Additional message text goes here.</span>
<span class="hljs-comment"># Note: 'wall' prints comment lines.</span>
zzz23EndOfMessagezzz23

<span class="hljs-comment"># Could have been done more efficiently by</span>
<span class="hljs-comment">#         wall &lt;message-file</span>
<span class="hljs-comment">#  However, embedding the message template in a script</span>
<span class="hljs-comment">#+ is a quick-and-dirty one-off solution.</span>

<span class="hljs-built_in">exit</span></pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="VIHERE" id="VIHERE"></a></p>
    <p>Even such unlikely candidates as the <i class="FIRSTTERM">vi</i> text editor lend themselves to <i class="FIRSTTERM">here documents</i>.</p>
    <div class="EXAMPLE">
      <a name="EX69" id="EX69"></a>
      <p><b>Example 19-2. <i class="FIRSTTERM">dummyfile</i>: Creates a 2-line dummy file</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># Noninteractive use of 'vi' to edit a file.</span>
<span class="hljs-comment"># Emulates 'sed'.</span>

E_BADARGS=85

<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]
<span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage: `basename <span class="hljs-variable">$0</span>` filename"</span>
  <span class="hljs-built_in">exit</span> <span class="hljs-variable">$E_BADARGS</span>
<span class="hljs-keyword">fi</span>

TARGETFILE=<span class="hljs-variable">$1</span>

<span class="hljs-comment"># Insert 2 lines in file, then save.</span>
<span class="hljs-comment">#--------Begin here document-----------#</span>
vi <span class="hljs-variable">$TARGETFILE</span> &lt;&lt;x23LimitStringx23
i
This is line 1 of the example file.
This is line 2 of the example file.
^[
ZZ
x23LimitStringx23
<span class="hljs-comment">#----------End here document-----------#</span>

<span class="hljs-comment">#  Note that ^[ above is a literal escape</span>
<span class="hljs-comment">#+ typed by Control-V &lt;Esc&gt;.</span>

<span class="hljs-comment">#  Bram Moolenaar points out that this may not work with 'vim'</span>
<span class="hljs-comment">#+ because of possible problems with terminal interaction.</span>

<span class="hljs-built_in">exit</span></pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p>The above script could just as effectively have been implemented with <b class="COMMAND">ex</b>, rather than <b class="COMMAND">vi</b>. <a name="EXSCRIPTREF" id="EXSCRIPTREF"></a><i class="FIRSTTERM">Here documents</i> containing a list of <b class="COMMAND">ex</b> commands are common enough to form their own category, known as <i class="FIRSTTERM">ex scripts</i>.</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment">#  Replace all instances of "Smith" with "Jones"</span>
<span class="hljs-comment">#+ in files with a ".txt" filename suffix. </span>

ORIGINAL=Smith
REPLACEMENT=Jones

<span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> $(fgrep -l <span class="hljs-variable">$ORIGINAL</span> *.txt)
<span class="hljs-keyword">do</span>
  <span class="hljs-comment"># -------------------------------------</span>
  ex <span class="hljs-variable">$word</span> &lt;&lt;EOF
  :%s/<span class="hljs-variable">$ORIGINAL</span>/<span class="hljs-variable">$REPLACEMENT</span>/g
  :wq
EOF
  <span class="hljs-comment"># :%s is the "ex" substitution command.</span>
  <span class="hljs-comment"># :wq is write-and-quit.</span>
  <span class="hljs-comment"># -------------------------------------</span>
<span class="hljs-keyword">done</span></pre>
        </td>
      </tr>
    </tbody></table>
    <p><a name="CATSCRIPTREF" id="CATSCRIPTREF"></a></p>
    <p>Analogous to <span class="QUOTE">"ex scripts"</span> are <i class="FIRSTTERM">cat scripts</i>.</p>
    <div class="EXAMPLE">
      <a name="EX71" id="EX71"></a>
      <p><b>Example 19-3. Multi-line message using <i class="FIRSTTERM">cat</i></b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment">#  'echo' is fine for printing single line messages,</span>
<span class="hljs-comment">#+  but somewhat problematic for for message blocks.</span>
<span class="hljs-comment">#   A 'cat' here document overcomes this limitation.</span>

cat &lt;&lt;End-of-message
-------------------------------------
This is line 1 of the message.
This is line 2 of the message.
This is line 3 of the message.
This is line 4 of the message.
This is the last line of the message.
-------------------------------------
End-of-message

<span class="hljs-comment">#  Replacing line 7, above, with</span>
<span class="hljs-comment">#+   cat &gt; $Newfile &lt;&lt;End-of-message</span>
<span class="hljs-comment">#+       ^^^^^^^^^^</span>
<span class="hljs-comment">#+ writes the output to the file $Newfile, rather than to stdout.</span>

<span class="hljs-built_in">exit</span> 0


<span class="hljs-comment">#--------------------------------------------</span>
<span class="hljs-comment"># Code below disabled, due to "exit 0" above.</span>

<span class="hljs-comment"># S.C. points out that the following also works.</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"-------------------------------------
This is line 1 of the message.
This is line 2 of the message.
This is line 3 of the message.
This is line 4 of the message.
This is the last line of the message.
-------------------------------------"</span>
<span class="hljs-comment"># However, text may not include double quotes unless they are escaped.</span></pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="LIMITSTRDASH" id="LIMITSTRDASH"></a></p>
    <p>The <tt class="OPTION">-</tt> option to mark a here document limit string (<tt class="USERINPUT"><b>&lt;&lt;-LimitString</b></tt>) suppresses leading tabs (but not spaces) in the output. This may be useful in making a script more readable.</p>
    <div class="EXAMPLE">
      <a name="EX71A" id="EX71A"></a>
      <p><b>Example 19-4. Multi-line message, with tabs suppressed</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># Same as previous example, but...</span>

<span class="hljs-comment">#  The - option to a here document &lt;&lt;-</span>
<span class="hljs-comment">#+ suppresses leading tabs in the body of the document,</span>
<span class="hljs-comment">#+ but *not* spaces.</span>

cat &lt;&lt;-ENDOFMESSAGE
        This is line 1 of the message.
        This is line 2 of the message.
        This is line 3 of the message.
        This is line 4 of the message.
        This is the last line of the message.
ENDOFMESSAGE
<span class="hljs-comment"># The output of the script will be flush left.</span>
<span class="hljs-comment"># Leading tab in each line will not show.</span>

<span class="hljs-comment"># Above 5 lines of "message" prefaced by a tab, not spaces.</span>
<span class="hljs-comment"># Spaces not affected by   &lt;&lt;-  .</span>

<span class="hljs-comment"># Note that this option has no effect on *embedded* tabs.</span>

<span class="hljs-built_in">exit</span> 0</pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="HEREPASSP" id="HEREPASSP"></a></p>
    <p>A <i class="FIRSTTERM">here document</i> supports parameter and command substitution. It is therefore possible to pass different parameters to the body of the here document, changing its output accordingly.</p>
    <div class="EXAMPLE">
      <a name="EX71B" id="EX71B"></a>
      <p><b>Example 19-5. Here document with replaceable parameters</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># Another 'cat' here document, using parameter substitution.</span>

<span class="hljs-comment"># Try it with no command-line parameters,   ./scriptname</span>
<span class="hljs-comment"># Try it with one command-line parameter,   ./scriptname Mortimer</span>
<span class="hljs-comment"># Try it with one two-word quoted command-line parameter,</span>
<span class="hljs-comment">#                           ./scriptname "Mortimer Jones"</span>

CMDLINEPARAM=1     <span class="hljs-comment">#  Expect at least command-line parameter.</span>

<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -ge <span class="hljs-variable">$CMDLINEPARAM</span> ]
<span class="hljs-keyword">then</span>
  NAME=<span class="hljs-variable">$1</span>          <span class="hljs-comment">#  If more than one command-line param,</span>
                   <span class="hljs-comment">#+ then just take the first.</span>
<span class="hljs-keyword">else</span>
  NAME=<span class="hljs-string">"John Doe"</span>  <span class="hljs-comment">#  Default, if no command-line parameter.</span>
<span class="hljs-keyword">fi</span>  

RESPONDENT=<span class="hljs-string">"the author of this fine script"</span>  
  

cat &lt;&lt;Endofmessage

Hello, there, <span class="hljs-variable">$NAME</span>.
Greetings to you, <span class="hljs-variable">$NAME</span>, from <span class="hljs-variable">$RESPONDENT</span>.

<span class="hljs-comment"># This comment shows up in the output (why?).</span>

Endofmessage

<span class="hljs-comment"># Note that the blank lines show up in the output.</span>
<span class="hljs-comment"># So does the comment.</span>

<span class="hljs-built_in">exit</span></pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="HEREPARAMSUB" id="HEREPARAMSUB"></a></p>
    <p>This is a useful script containing a <i class="FIRSTTERM">here document</i> with parameter substitution.</p>
    <div class="EXAMPLE">
      <a name="EX72" id="EX72"></a>
      <p><b>Example 19-6. Upload a file pair to <i class="FIRSTTERM">Sunsite</i> incoming directory</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># upload.sh</span>

<span class="hljs-comment">#  Upload file pair (Filename.lsm, Filename.tar.gz)</span>
<span class="hljs-comment">#+ to incoming directory at Sunsite/UNC (ibiblio.org).</span>
<span class="hljs-comment">#  Filename.tar.gz is the tarball itself.</span>
<span class="hljs-comment">#  Filename.lsm is the descriptor file.</span>
<span class="hljs-comment">#  Sunsite requires "lsm" file, otherwise will bounce contributions.</span>


E_ARGERROR=85

<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]
<span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage: `basename <span class="hljs-variable">$0</span>` Filename-to-upload"</span>
  <span class="hljs-built_in">exit</span> <span class="hljs-variable">$E_ARGERROR</span>
<span class="hljs-keyword">fi</span>  


Filename=`basename <span class="hljs-variable">$1</span>`           <span class="hljs-comment"># Strips pathname out of file name.</span>

Server=<span class="hljs-string">"ibiblio.org"</span>
Directory=<span class="hljs-string">"/incoming/Linux"</span>
<span class="hljs-comment">#  These need not be hard-coded into script,</span>
<span class="hljs-comment">#+ but may instead be changed to command-line argument.</span>

Password=<span class="hljs-string">"your.e-mail.address"</span>   <span class="hljs-comment"># Change above to suit.</span>

ftp -n <span class="hljs-variable">$Server</span> &lt;&lt;End-Of-Session
<span class="hljs-comment"># -n option disables auto-logon</span>

user anonymous <span class="hljs-string">"<span class="hljs-variable">$Password</span>"</span>       <span class="hljs-comment">#  If this doesn't work, then try:</span>
                                 <span class="hljs-comment">#  quote user anonymous "$Password"</span>
binary
bell                             <span class="hljs-comment"># Ring 'bell' after each file transfer.</span>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">$Directory</span>
put <span class="hljs-string">"<span class="hljs-variable">$Filename</span>.lsm"</span>
put <span class="hljs-string">"<span class="hljs-variable">$Filename</span>.tar.gz"</span>
<span class="hljs-built_in">bye</span>
End-Of-Session

<span class="hljs-built_in">exit</span> 0</pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="HEREESC" id="HEREESC"></a></p>
    <p>Quoting or escaping the <span class="QUOTE">"limit string"</span> at the head of a here document disables parameter substitution within its body. The reason for this is that <i class="FIRSTTERM">quoting/escaping the limit string</i> effectively <a href="escapingsection.html#ESCP">escapes</a> the <span class="TOKEN">$</span>, <span class="TOKEN">`</span>, and <span class="TOKEN">\</span> <a href="special-chars.html#SCHARLIST">special characters</a>, and causes them to be interpreted literally. (Thank you, Allen Halsey, for pointing this out.)</p>
    <div class="EXAMPLE">
      <a name="EX71C" id="EX71C"></a>
      <p><b>Example 19-7. Parameter substitution turned off</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment">#  A 'cat' here-document, but with parameter substitution disabled.</span>

NAME=<span class="hljs-string">"John Doe"</span>
RESPONDENT=<span class="hljs-string">"the author of this fine script"</span>  

cat &lt;&lt;<span class="hljs-string">'Endofmessage'</span>

Hello, there, <span class="hljs-variable">$NAME</span>.
Greetings to you, <span class="hljs-variable">$NAME</span>, from <span class="hljs-variable">$RESPONDENT</span>.

Endofmessage

<span class="hljs-comment">#   No parameter substitution when the "limit string" is quoted or escaped.</span>
<span class="hljs-comment">#   Either of the following at the head of the here document would have</span>
<span class="hljs-comment">#+  the same effect.</span>
<span class="hljs-comment">#   cat &lt;&lt;"Endofmessage"</span>
<span class="hljs-comment">#   cat &lt;&lt;\Endofmessage</span>



<span class="hljs-comment">#   And, likewise:</span>

cat &lt;&lt;<span class="hljs-string">"SpecialCharTest"</span>

Directory listing would follow
<span class="hljs-keyword">if</span> <span class="hljs-built_in">limit</span> string were not quoted.
`ls -l`

Arithmetic expansion would take place
<span class="hljs-keyword">if</span> <span class="hljs-built_in">limit</span> string were not quoted.
$((<span class="hljs-number">5</span> + <span class="hljs-number">3</span>))

A a single backslash would <span class="hljs-built_in">echo</span>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">limit</span> string were not quoted.
\\

SpecialCharTest


<span class="hljs-built_in">exit</span></pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="HERELIT" id="HERELIT"></a></p>
    <p>Disabling parameter substitution permits outputting literal text. Generating scripts or even program code is one use for this.</p>
    <div class="EXAMPLE">
      <a name="GENERATESCRIPT" id="GENERATESCRIPT"></a>
      <p><b>Example 19-8. A script that generates another script</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># generate-script.sh</span>
<span class="hljs-comment"># Based on an idea by Albert Reiner.</span>

OUTFILE=generated.sh         <span class="hljs-comment"># Name of the file to generate.</span>


<span class="hljs-comment"># -----------------------------------------------------------</span>
<span class="hljs-comment"># 'Here document containing the body of the generated script.</span>
(
cat &lt;&lt;<span class="hljs-string">'EOF'</span>
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"This is a generated shell script."</span>
<span class="hljs-comment">#  Note that since we are inside a subshell,</span>
<span class="hljs-comment">#+ we can't access variables in the "outside" script.</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"Generated file will be named: <span class="hljs-variable">$OUTFILE</span>"</span>
<span class="hljs-comment">#  Above line will not work as normally expected</span>
<span class="hljs-comment">#+ because parameter expansion has been disabled.</span>
<span class="hljs-comment">#  Instead, the result is literal output.</span>

a=7
b=3

<span class="hljs-built_in">let</span> <span class="hljs-string">"c = <span class="hljs-variable">$a</span> * <span class="hljs-variable">$b</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"c = <span class="hljs-variable">$c</span>"</span>

<span class="hljs-built_in">exit</span> 0
EOF
) &gt; <span class="hljs-variable">$OUTFILE</span>
<span class="hljs-comment"># -----------------------------------------------------------</span>

<span class="hljs-comment">#  Quoting the 'limit string' prevents variable expansion</span>
<span class="hljs-comment">#+ within the body of the above 'here document.'</span>
<span class="hljs-comment">#  This permits outputting literal strings in the output file.</span>

<span class="hljs-keyword">if</span> [ -f <span class="hljs-string">"<span class="hljs-variable">$OUTFILE</span>"</span> ]
<span class="hljs-keyword">then</span>
  chmod 755 <span class="hljs-variable">$OUTFILE</span>
  <span class="hljs-comment"># Make the generated file executable.</span>
<span class="hljs-keyword">else</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Problem in creating file: \"<span class="hljs-variable">$OUTFILE</span>\""</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment">#  This method also works for generating</span>
<span class="hljs-comment">#+ C programs, Perl programs, Python programs, Makefiles,</span>
<span class="hljs-comment">#+ and the like.</span>

<span class="hljs-built_in">exit</span> 0</pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="HERECS" id="HERECS"></a></p>
    <p>It is possible to set a variable from the output of a here document. This is actually a devious form of <a href="commandsub.html#COMMANDSUBREF">command substitution</a>.</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs">variable=$(cat &lt;&lt;SETVAR
This variable
runs over multiple lines.
SETVAR
)

<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span></pre>
        </td>
      </tr>
    </tbody></table>
    <p><a name="HEREFUNC" id="HEREFUNC"></a></p>
    <p>A here document can supply input to a function in the same script.</p>
    <div class="EXAMPLE">
      <a name="HF" id="HF"></a>
      <p><b>Example 19-9. Here documents and functions</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># here-function.sh</span>

<span class="hljs-function"><span class="hljs-title">GetPersonalData</span></span> ()
{
  <span class="hljs-built_in">read</span> firstname
  <span class="hljs-built_in">read</span> lastname
  <span class="hljs-built_in">read</span> address
  <span class="hljs-built_in">read</span> city 
  <span class="hljs-built_in">read</span> state 
  <span class="hljs-built_in">read</span> zipcode
} <span class="hljs-comment"># This certainly appears to be an interactive function, but . . .</span>


<span class="hljs-comment"># Supply input to the above function.</span>
GetPersonalData &lt;&lt;RECORD001
Bozo
Bozeman
2726 Nondescript Dr.
Bozeman
MT
21226
RECORD001


<span class="hljs-built_in">echo</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$firstname</span> <span class="hljs-variable">$lastname</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$address</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$city</span>, <span class="hljs-variable">$state</span> <span class="hljs-variable">$zipcode</span>"</span>
<span class="hljs-built_in">echo</span>

<span class="hljs-built_in">exit</span> 0</pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="ANONHEREDOC0" id="ANONHEREDOC0"></a></p>
    <p>It is possible to use <span class="TOKEN">:</span> as a dummy command accepting output from a here document. This, in effect, creates an <span class="QUOTE">"anonymous"</span> here document.</p>
    <div class="EXAMPLE">
      <a name="ANONHEREDOC" id="ANONHEREDOC"></a>
      <p><b>Example 19-10. <span class="QUOTE">"Anonymous"</span> Here Document</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

: &lt;&lt;TESTVARIABLES
<span class="hljs-variable">${HOSTNAME?}</span><span class="hljs-variable">${USER?}</span><span class="hljs-variable">${MAIL?}</span>  <span class="hljs-comment"># Print error message if one of the variables not set.</span>
TESTVARIABLES

<span class="hljs-built_in">exit</span> $?</pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="CBLOCK1" id="CBLOCK1"></a></p>
    <div class="TIP">
      <table class="TIP" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/tip.gif" hspace="5" alt="Tip"></td>
          <td align="left" valign="top">
            <p>A variation of the above technique permits <span class="QUOTE">"commenting out"</span> blocks of code.</p>
          </td>
        </tr>
      </tbody></table>
    </div>
    <div class="EXAMPLE">
      <a name="COMMENTBLOCK" id="COMMENTBLOCK"></a>
      <p><b>Example 19-11. Commenting out a block of code</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># commentblock.sh</span>

: &lt;&lt;COMMENTBLOCK
<span class="hljs-built_in">echo</span> <span class="hljs-string">"This line will not echo."</span>
This is a comment line missing the <span class="hljs-string">"#"</span> prefix.
This is another comment line missing the <span class="hljs-string">"#"</span> prefix.

&amp;*@!!++=
The above line will cause no error message,
because the Bash interpreter will ignore it.
COMMENTBLOCK

<span class="hljs-built_in">echo</span> <span class="hljs-string">"Exit value of above \"COMMENTBLOCK\" is $?."</span>   <span class="hljs-comment"># 0</span>
<span class="hljs-comment"># No error shown.</span>
<span class="hljs-built_in">echo</span>


<span class="hljs-comment">#  The above technique also comes in useful for commenting out</span>
<span class="hljs-comment">#+ a block of working code for debugging purposes.</span>
<span class="hljs-comment">#  This saves having to put a "#" at the beginning of each line,</span>
<span class="hljs-comment">#+ then having to go back and delete each "#" later.</span>
<span class="hljs-comment">#  Note that the use of of colon, above, is optional.</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"Just before commented-out code block."</span>
<span class="hljs-comment">#  The lines of code between the double-dashed lines will not execute.</span>
<span class="hljs-comment">#  ===================================================================</span>
: &lt;&lt;DEBUGXXX
<span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> *
<span class="hljs-keyword">do</span>
 cat <span class="hljs-string">"<span class="hljs-variable">$file</span>"</span>
<span class="hljs-keyword">done</span>
DEBUGXXX
<span class="hljs-comment">#  ===================================================================</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Just after commented-out code block."</span>

<span class="hljs-built_in">exit</span> 0



<span class="hljs-comment">######################################################################</span>
<span class="hljs-comment">#  Note, however, that if a bracketed variable is contained within</span>
<span class="hljs-comment">#+ the commented-out code block,</span>
<span class="hljs-comment">#+ then this could cause problems.</span>
<span class="hljs-comment">#  for example:</span>


<span class="hljs-comment">#/!/bin/bash</span>

  : &lt;&lt;COMMENTBLOCK
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"This line will not echo."</span>
  &amp;*@!!++=
  <span class="hljs-variable">${foo_bar_bazz?}</span>
  $(rm -rf /tmp/foobar/)
  $(touch my_build_directory/cups/Makefile)
COMMENTBLOCK


$ sh commented-bad.sh
commented-bad.sh: line 3: foo_bar_bazz: parameter null or not <span class="hljs-built_in">set</span>

<span class="hljs-comment"># The remedy for this is to strong-quote the 'COMMENTBLOCK' in line 49, above.</span>

  : &lt;&lt;<span class="hljs-string">'COMMENTBLOCK'</span>

<span class="hljs-comment"># Thank you, Kurt Pfeifle, for pointing this out.</span></pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="HSELFDOC" id="HSELFDOC"></a></p>
    <div class="TIP">
      <table class="TIP" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/tip.gif" hspace="5" alt="Tip"></td>
          <td align="left" valign="top">
            <p>Yet another twist of this nifty trick makes <span class="QUOTE">"self-documenting"</span> scripts possible.</p>
          </td>
        </tr>
      </tbody></table>
    </div>
    <div class="EXAMPLE">
      <a name="SELFDOCUMENT" id="SELFDOCUMENT"></a>
      <p><b>Example 19-12. A self-documenting script</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># self-document.sh: self-documenting script</span>
<span class="hljs-comment"># Modification of "colm.sh".</span>

DOC_REQUEST=70

<span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> = <span class="hljs-string">"-h"</span>  -o <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> = <span class="hljs-string">"--help"</span> ]     <span class="hljs-comment"># Request help.</span>
<span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span>; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage: <span class="hljs-variable">$0</span> [directory-name]"</span>; <span class="hljs-built_in">echo</span>
  sed --silent -e <span class="hljs-string">'/DOCUMENTATIONXX$/,/^DOCUMENTATIONXX$/p'</span> <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span> |
  sed -e <span class="hljs-string">'/DOCUMENTATIONXX$/d'</span>; <span class="hljs-built_in">exit</span> <span class="hljs-variable">$DOC_REQUEST</span>; <span class="hljs-keyword">fi</span>


: &lt;&lt;DOCUMENTATIONXX
List the statistics of a specified directory <span class="hljs-keyword">in</span> tabular format.
---------------------------------------------------------------
The command-line parameter gives the directory to be listed.
If no directory specified or directory specified cannot be <span class="hljs-built_in">read</span>,
<span class="hljs-keyword">then</span> list the current working directory.

DOCUMENTATIONXX

<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> -o ! -r <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]
<span class="hljs-keyword">then</span>
  directory=.
<span class="hljs-keyword">else</span>
  directory=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>
<span class="hljs-keyword">fi</span>  

<span class="hljs-built_in">echo</span> <span class="hljs-string">"Listing of "</span><span class="hljs-variable">$directory</span><span class="hljs-string">":"</span>; <span class="hljs-built_in">echo</span>
(<span class="hljs-built_in">printf</span> <span class="hljs-string">"PERMISSIONS LINKS OWNER GROUP SIZE MONTH DAY HH:MM PROG-NAME\n"</span> \
; ls -l <span class="hljs-string">"<span class="hljs-variable">$directory</span>"</span> | sed 1d) | column -t

<span class="hljs-built_in">exit</span> 0</pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p>Using a <a href="here-docs.html#CATSCRIPTREF">cat script</a> is an alternate way of accomplishing this.</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs">DOC_REQUEST=70

<span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> = <span class="hljs-string">"-h"</span>  -o <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> = <span class="hljs-string">"--help"</span> ]     <span class="hljs-comment"># Request help.</span>
<span class="hljs-keyword">then</span>                                       <span class="hljs-comment"># Use a "cat script" . . .</span>
  cat &lt;&lt;DOCUMENTATIONXX
List the statistics of a specified directory <span class="hljs-keyword">in</span> tabular format.
---------------------------------------------------------------
The command-line parameter gives the directory to be listed.
If no directory specified or directory specified cannot be <span class="hljs-built_in">read</span>,
<span class="hljs-keyword">then</span> list the current working directory.

DOCUMENTATIONXX
<span class="hljs-built_in">exit</span> <span class="hljs-variable">$DOC_REQUEST</span>
<span class="hljs-keyword">fi</span></pre>
        </td>
      </tr>
    </tbody></table>
    <p>See also <a href="contributed-scripts.html#ISSPAMMER2">Example A-28</a>, <a href="contributed-scripts.html#PETALS">Example A-40</a>, <a href="contributed-scripts.html#QKY">Example A-41</a>, and <a href="contributed-scripts.html#NIM">Example A-42</a> for more examples of self-documenting scripts.</p>
    <p><a name="HERETEMP" id="HERETEMP"></a></p>
    <div class="NOTE">
      <table class="NOTE no-border" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/note.gif" hspace="5" alt="Note"></td>
          <td align="left" valign="top">
            <p>Here documents create temporary files, but these files are deleted after opening and are not accessible to any other process.</p>
            <table border="1" bgcolor="#E0E0E0" width="100%" class="no-border">
              <tbody><tr>
                <td>
                  <pre class="SCREEN hljs"><span class="hljs-meta">bash$</span><span class="bash"> bash -c <span class="hljs-string">'lsof -a -p $$ -d0'</span> &lt;&lt; EOF</span>
<span class="hljs-meta">&gt;</span><span class="bash"> EOF</span>
lsof    1213 bozo    0r   REG    3,5    0 30386 /tmp/t1213-0-sh (deleted)
              </pre>
                </td>
              </tr>
            </tbody></table>
          </td>
        </tr>
      </tbody></table>
    </div>
    <div class="CAUTION">
      <table class="CAUTION" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/caution.gif" hspace="5" alt="Caution"></td>
          <td align="left" valign="top">
            <p>Some utilities will not work inside a <i class="FIRSTTERM">here document</i>.</p>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="INDENTEDLS" id="INDENTEDLS"></a></p>
    <div class="WARNING">
      <table class="WARNING" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/warning.gif" hspace="5" alt="Warning"></td>
          <td align="left" valign="top">
            <p>The closing <i class="FIRSTTERM">limit string</i>, on the final line of a here document, must start in the <em>first</em> character position. There can be <em>no leading whitespace</em>. Trailing whitespace after the limit string likewise causes unexpected behavior. The whitespace prevents the limit string from being recognized. <a name="AEN17822" href="#FTN.AEN17822" id="AEN17822"><span class="footnote">[1]</span></a></p>
            <table border="0" bgcolor="#E0E0E0" width="100%">
              <tbody><tr>
                <td>
                  <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"----------------------------------------------------------------------"</span>

cat &lt;&lt;LimitString
<span class="hljs-built_in">echo</span> <span class="hljs-string">"This is line 1 of the message inside the here document."</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"This is line 2 of the message inside the here document."</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"This is the final line of the message inside the here document."</span>
     LimitString
<span class="hljs-comment">#^^^^Indented limit string. Error! This script will not behave as expected.</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"----------------------------------------------------------------------"</span>

<span class="hljs-comment">#  These comments are outside the 'here document',</span>
<span class="hljs-comment">#+ and should not echo.</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"Outside the here document."</span>

<span class="hljs-built_in">exit</span> 0

<span class="hljs-built_in">echo</span> <span class="hljs-string">"This line had better not echo."</span>  <span class="hljs-comment"># Follows an 'exit' command.</span></pre>
                </td>
              </tr>
            </tbody></table>
          </td>
        </tr>
      </tbody></table>
    </div>
    <div class="CAUTION">
      <table class="CAUTION" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/caution.gif" hspace="5" alt="Caution"></td>
          <td align="left" valign="top">
            <p><a name="EXCLLS" id="EXCLLS"></a>Some people very cleverly use a single <span class="TOKEN">!</span> as a limit string. But, that's not necessarily a good idea.</p>
            <table border="0" bgcolor="#E0E0E0" width="100%">
              <tbody><tr>
                <td>
                  <pre class="PROGRAMLISTING hljs"><span class="hljs-comment"># This works.</span>
cat &lt;&lt;!
Hello!
! Three more exclamations !!!
!


<span class="hljs-comment"># But . . .</span>
cat &lt;&lt;!
Hello!
Single exclamation point follows!
!
!
<span class="hljs-comment"># Crashes with an error message.</span>


<span class="hljs-comment"># However, the following will work.</span>
cat &lt;&lt;EOF
Hello!
Single exclamation point follows!
!
EOF
<span class="hljs-comment"># It's safer to use a multi-character limit string.</span></pre>
                </td>
              </tr>
            </tbody></table>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p>For those tasks too complex for a <i class="FIRSTTERM">here document</i>, consider using the <tt class="REPLACEABLE"><i>expect</i></tt> scripting language, which was specifically designed for feeding input into interactive programs.</p>
  </div>
  <h3 class="FOOTNOTES">Notes</h3>
  <table border="0" class="FOOTNOTES" width="100%">
    <tbody><tr>
      <td align="left" valign="top" width="5%"><a name="FTN.AEN17822" href="here-docs.html#AEN17822" id="FTN.AEN17822"><span class="footnote">[1]</span></a></td>
      <td align="left" valign="top" width="95%">
        <p>Except, as Dennis Benzinger points out, if <a href="here-docs.html#LIMITSTRDASH">using <b class="COMMAND">&lt;&lt;-</b> to suppress tabs</a>.</p>
      </td>
    </tr>
  </tbody></table>
  <div class="NAVFOOTER">
    <hr align="left" width="100%">
    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <td width="33%" align="left" valign="top"><a href="globbingref.html" accesskey="P">Prev</a></td>
        <td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>
        <td width="33%" align="right" valign="top"><a href="x17837.html" accesskey="N">Next</a></td>
      </tr>
      <tr>
        <td width="33%" align="left" valign="top">Globbing</td>
        <td width="34%" align="center" valign="top"><a href="part5.html" accesskey="U">Up</a></td>
        <td width="33%" align="right" valign="top">Here Strings</td>
      </tr>
    </tbody></table>
  </div>


<button id="theme-toggle">Toggle theme</button></body></html>
