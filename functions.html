<!DOCTYPE html><html><head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.7.28">
  <title>Functions</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.7">
  <link rel="HOME" title="Advanced Bash-Scripting Guide" href="index.html">
  <link rel="UP" title="Advanced Topics" href="part5.html">
  <link rel="PREVIOUS" title="Process Substitution" href="process-sub.html">
  <link rel="NEXT" title="Complex Functions and Function Complexities" href="complexfunct.html">
<link rel="stylesheet" href="styles/custom.css"><link rel="stylesheet" href="styles/atom-one-dark.css"><script>
    document.addEventListener('DOMContentLoaded', () => {
      const manuallySetTheme = localStorage.getItem('bash-guide-theme');

      if (manuallySetTheme === 'dark') document.body.classList.add('dark-mode');
      else if (manuallySetTheme === 'light') document.body.classList.remove('dark-mode');
      else if (matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark-mode');
      }

      document.getElementById('theme-toggle').addEventListener(
        'click',
        () => {
          const isSet = document.body.classList.toggle('dark-mode');
          localStorage.setItem('bash-guide-theme', isSet ? 'dark' : 'light');
        }
      );
    });
  </script></head>
<body class="CHAPTER" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <th colspan="3" align="center">Advanced Bash-Scripting Guide:</th>
      </tr>
      <tr>
        <td width="10%" align="left" valign="bottom"><a href="process-sub.html" accesskey="P">Prev</a></td>
        <td width="80%" align="center" valign="bottom"></td>
        <td width="10%" align="right" valign="bottom"><a href="complexfunct.html" accesskey="N">Next</a></td>
      </tr>
    </tbody></table>
    <hr align="left" width="100%">
  </div>
  <div class="CHAPTER">
    <h1><a name="FUNCTIONS" id="FUNCTIONS"></a>Chapter 24. Functions</h1>
    <div class="TOC">
      <dl>
        <dt><b>Table of Contents</b></dt>
        <dt>24.1. <a href="complexfunct.html">Complex Functions and Function Complexities</a></dt>
        <dt>24.2. <a href="localvar.html">Local Variables</a></dt>
        <dt>24.3. <a href="recurnolocvar.html">Recursion Without Local Variables</a></dt>
      </dl>
    </div>
    <p><a name="FUNCTIONREF" id="FUNCTIONREF"></a></p>
    <p>Like <span class="QUOTE">"real"</span> programming languages, Bash has functions, though in a somewhat limited implementation. A function is a subroutine, a <a href="special-chars.html#CODEBLOCKREF">code block</a> that implements a set of operations, a <span class="QUOTE">"black box"</span> that performs a specified task. Wherever there is repetitive code, when a task repeats with only slight variations in procedure, then consider using a function.</p>
    <p><b class="COMMAND">function</b> <tt class="REPLACEABLE"><i>function_name</i></tt> {<br>
    <tt class="REPLACEABLE"><i>command</i></tt>...<br>
    }<br></p>or
    <p><tt class="REPLACEABLE"><i>function_name</i></tt> () {<br>
    <tt class="REPLACEABLE"><i>command</i></tt>...<br>
    }<br></p>
    <p>This second form will cheer the hearts of C programmers (and is more <a href="portabilityissues.html">portable</a>).</p>
    <p>As in C, the function's opening bracket may optionally appear on the second line.</p>
    <p><tt class="REPLACEABLE"><i>function_name</i></tt> ()<br>
    {<br>
    <tt class="REPLACEABLE"><i>command</i></tt>...<br>
    }<br></p>
    <div class="NOTE">
      <table class="NOTE" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/note.gif" hspace="5" alt="Note"></td>
          <td align="left" valign="top">
            <p>A function may be <span class="QUOTE">"compacted"</span> into a single line.</p>
            <table border="0" bgcolor="#E0E0E0" width="100%">
              <tbody><tr>
                <td>
                  <pre class="PROGRAMLISTING hljs"><span class="hljs-function"><span class="hljs-title">fun</span></span> () { <span class="hljs-built_in">echo</span> <span class="hljs-string">"This is a function"</span>; <span class="hljs-built_in">echo</span>; }
<span class="hljs-comment">#                                 ^     ^</span></pre>
                </td>
              </tr>
            </tbody></table>
            <p>In this case, however, a <i class="FIRSTTERM">semicolon</i> must follow the final command in the function.</p>
            <table border="0" bgcolor="#E0E0E0" width="100%">
              <tbody><tr>
                <td>
                  <pre class="PROGRAMLISTING hljs"><span class="hljs-function"><span class="hljs-title">fun</span></span> () { <span class="hljs-built_in">echo</span> <span class="hljs-string">"This is a function"</span>; <span class="hljs-built_in">echo</span> } <span class="hljs-comment"># Error!</span>
<span class="hljs-comment">#                                       ^</span>

<span class="hljs-function"><span class="hljs-title">fun2</span></span> () { <span class="hljs-built_in">echo</span> <span class="hljs-string">"Even a single-command function? Yes!"</span>; }
<span class="hljs-comment">#                                                    ^</span></pre>
                </td>
              </tr>
            </tbody></table>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p>Functions are called, <i class="FIRSTTERM">triggered</i>, simply by invoking their names. <em>A function call is equivalent to a command.</em></p>
    <div class="EXAMPLE">
      <a name="EX59" id="EX59"></a>
      <p><b>Example 24-1. Simple functions</b></p>
      <table border="0" bgcolor="#E0E0E0" width="100%">
        <tbody><tr>
          <td>
            <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># ex59.sh: Exercising functions (simple).</span>

JUST_A_SECOND=1

<span class="hljs-function"><span class="hljs-title">funky</span></span> ()
{ <span class="hljs-comment"># This is about as simple as functions get.</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"This is a funky function."</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Now exiting funky function."</span>
} <span class="hljs-comment"># Function declaration must precede call.</span>


<span class="hljs-function"><span class="hljs-title">fun</span></span> ()
{ <span class="hljs-comment"># A somewhat more complex function.</span>
  i=0
  REPEATS=30

  <span class="hljs-built_in">echo</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"And now the fun really begins."</span>
  <span class="hljs-built_in">echo</span>

  sleep <span class="hljs-variable">$JUST_A_SECOND</span>    <span class="hljs-comment"># Hey, wait a second!</span>
  <span class="hljs-keyword">while</span> [ <span class="hljs-variable">$i</span> -lt <span class="hljs-variable">$REPEATS</span> ]
  <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"----------FUNCTIONS----------&gt;"</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"&lt;------------ARE-------------"</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"&lt;------------FUN------------&gt;"</span>
    <span class="hljs-built_in">echo</span>
    <span class="hljs-built_in">let</span> <span class="hljs-string">"i+=1"</span>
  <span class="hljs-keyword">done</span>
}

  <span class="hljs-comment"># Now, call the functions.</span>

funky
fun

<span class="hljs-built_in">exit</span> $?</pre>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p><a name="FUNCTDEFMUST" id="FUNCTDEFMUST"></a></p>
    <p>The function definition must precede the first call to it. There is no method of <span class="QUOTE">"declaring"</span> the function, as, for example, in C.</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs">f1
<span class="hljs-comment"># Will give an error message, since function "f1" not yet defined.</span>

<span class="hljs-built_in">declare</span> -f f1      <span class="hljs-comment"># This doesn't help either.</span>
f1                 <span class="hljs-comment"># Still an error message.</span>

<span class="hljs-comment"># However...</span>

          
<span class="hljs-function"><span class="hljs-title">f1</span></span> ()
{
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Calling function \"f2\" from within function \"f1\"."</span>
  f2
}

<span class="hljs-function"><span class="hljs-title">f2</span></span> ()
{
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Function \"f2\"."</span>
}

f1  <span class="hljs-comment">#  Function "f2" is not actually called until this point,</span>
    <span class="hljs-comment">#+ although it is referenced before its definition.</span>
    <span class="hljs-comment">#  This is permissible.</span>
    
    <span class="hljs-comment"># Thanks, S.C.</span></pre>
        </td>
      </tr>
    </tbody></table>
    <div class="NOTE">
      <table class="NOTE" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/note.gif" hspace="5" alt="Note"></td>
          <td align="left" valign="top">
            <p><a name="EMPTYFUNC" id="EMPTYFUNC"></a>Functions may not be empty!</p>
            <table border="0" bgcolor="#E0E0E0" width="100%">
              <tbody><tr>
                <td>
                  <pre class="PROGRAMLISTING hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># empty-function.sh</span>

<span class="hljs-function"><span class="hljs-title">empty</span></span> ()
{
}

<span class="hljs-built_in">exit</span> 0  <span class="hljs-comment"># Will not exit here!</span>

<span class="hljs-comment"># $ sh empty-function.sh</span>
<span class="hljs-comment"># empty-function.sh: line 6: syntax error near unexpected token `}'</span>
<span class="hljs-comment"># empty-function.sh: line 6: `}'</span>

<span class="hljs-comment"># $ echo $?</span>
<span class="hljs-comment"># 2</span>


<span class="hljs-comment"># Note that a function containing only comments is empty.</span>

<span class="hljs-function"><span class="hljs-title">func</span></span> ()
{
  <span class="hljs-comment"># Comment 1.</span>
  <span class="hljs-comment"># Comment 2.</span>
  <span class="hljs-comment"># This is still an empty function.</span>
  <span class="hljs-comment"># Thank you, Mark Bova, for pointing this out.</span>
}
<span class="hljs-comment"># Results in same error message as above.</span>


<span class="hljs-comment"># However ...</span>

<span class="hljs-function"><span class="hljs-title">not_quite_empty</span></span> ()
{
  illegal_command
} <span class="hljs-comment">#  A script containing this function will *not* bomb</span>
  <span class="hljs-comment">#+ as long as the function is not called.</span>

<span class="hljs-function"><span class="hljs-title">not_empty</span></span> ()
{
  :
} <span class="hljs-comment"># Contains a : (null command), and this is okay.</span>


<span class="hljs-comment"># Thank you, Dominick Geyer and Thiemo Kellner.</span></pre>
                </td>
              </tr>
            </tbody></table>
          </td>
        </tr>
      </tbody></table>
    </div>
    <p>It is even possible to nest a function within another function, although this is not very useful.</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs"><span class="hljs-function"><span class="hljs-title">f1</span></span> ()
{

  f2 () <span class="hljs-comment"># nested</span>
  {
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Function \"f2\", inside \"f1\"."</span>
  }

}  

f2  <span class="hljs-comment">#  Gives an error message.</span>
    <span class="hljs-comment">#  Even a preceding "declare -f f2" wouldn't help.</span>

<span class="hljs-built_in">echo</span>    

f1  <span class="hljs-comment">#  Does nothing, since calling "f1" does not automatically call "f2".</span>
f2  <span class="hljs-comment">#  Now, it's all right to call "f2",</span>
    <span class="hljs-comment">#+ since its definition has been made visible by calling "f1".</span>

    <span class="hljs-comment"># Thanks, S.C.</span></pre>
        </td>
      </tr>
    </tbody></table>
    <p>Function declarations can appear in unlikely places, even where a command would otherwise go.</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs">ls -l | <span class="hljs-function"><span class="hljs-title">foo</span></span>() { <span class="hljs-built_in">echo</span> <span class="hljs-string">"foo"</span>; }  <span class="hljs-comment"># Permissible, but useless.</span>



<span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$USER</span>"</span> = bozo ]
<span class="hljs-keyword">then</span>
  bozo_greet ()   <span class="hljs-comment"># Function definition embedded in an if/then construct.</span>
  {
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello, Bozo."</span>
  }
<span class="hljs-keyword">fi</span>  

bozo_greet        <span class="hljs-comment"># Works only for Bozo, and other users get an error.</span>



<span class="hljs-comment"># Something like this might be useful in some contexts.</span>
NO_EXIT=1   <span class="hljs-comment"># Will enable function definition below.</span>

[[ <span class="hljs-variable">$NO_EXIT</span> -eq 1 ]] &amp;&amp; <span class="hljs-function"><span class="hljs-title">exit</span></span>() { <span class="hljs-literal">true</span>; }     <span class="hljs-comment"># Function definition in an "and-list".</span>
<span class="hljs-comment"># If $NO_EXIT is 1, declares "exit ()".</span>
<span class="hljs-comment"># This disables the "exit" builtin by aliasing it to "true".</span>

<span class="hljs-built_in">exit</span>  <span class="hljs-comment"># Invokes "exit ()" function, not "exit" builtin.</span>



<span class="hljs-comment"># Or, similarly:</span>
filename=file1

[ -f <span class="hljs-string">"<span class="hljs-variable">$filename</span>"</span> ] &amp;&amp;
<span class="hljs-function"><span class="hljs-title">foo</span></span> () { rm -f <span class="hljs-string">"<span class="hljs-variable">$filename</span>"</span>; <span class="hljs-built_in">echo</span> <span class="hljs-string">"File "</span><span class="hljs-variable">$filename</span><span class="hljs-string">" deleted."</span>; } ||
<span class="hljs-function"><span class="hljs-title">foo</span></span> () { <span class="hljs-built_in">echo</span> <span class="hljs-string">"File "</span><span class="hljs-variable">$filename</span><span class="hljs-string">" not found."</span>; touch bar; }

foo

<span class="hljs-comment"># Thanks, S.C. and Christopher Head</span></pre>
        </td>
      </tr>
    </tbody></table>
    <p><a name="FSTRANGEREF" id="FSTRANGEREF"></a>Function names can take strange forms.</p>
    <table border="0" bgcolor="#E0E0E0" width="100%">
      <tbody><tr>
        <td>
          <pre class="PROGRAMLISTING hljs">  <span class="hljs-function"><span class="hljs-title">_</span></span>(){ <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> {1..10}; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$FUNCNAME</span>"</span>; <span class="hljs-keyword">done</span>; <span class="hljs-built_in">echo</span>; }
<span class="hljs-comment"># ^^^         No space between function name and parentheses.</span>
<span class="hljs-comment">#             This doesn't always work. Why not?</span>

<span class="hljs-comment"># Now, let's invoke the function.</span>
  _         <span class="hljs-comment"># __________</span>
<span class="hljs-comment">#             ^^^^^^^^^^   10 underscores (10 x function name)!  </span>
<span class="hljs-comment"># A "naked" underscore is an acceptable function name.</span>


<span class="hljs-comment"># In fact, a colon is likewise an acceptable function name.</span>

:(){ <span class="hljs-built_in">echo</span> <span class="hljs-string">":"</span>; }; :

<span class="hljs-comment"># Of what use is this?</span>
<span class="hljs-comment"># It's a devious way to obfuscate the code in a script.</span></pre>
        </td>
      </tr>
    </tbody></table>See also <a href="contributed-scripts.html#GRONSFELD">Example A-56</a>
    <div class="NOTE">
      <table class="NOTE" width="100%" border="0">
        <tbody><tr>
          <td width="25" align="center" valign="top"><img src="images/note.gif" hspace="5" alt="Note"></td>
          <td align="left" valign="top">
            <p>What happens when different versions of the same function appear in a script?</p>
            <table border="0" bgcolor="#E0E0E0" width="100%">
              <tbody><tr>
                <td>
                  <pre class="PROGRAMLISTING hljs"><span class="hljs-comment">#  As Yan Chen points out,</span>
<span class="hljs-comment">#  when a function is defined multiple times,</span>
<span class="hljs-comment">#  the final version is what is invoked.</span>
<span class="hljs-comment">#  This is not, however, particularly useful.</span>

<span class="hljs-function"><span class="hljs-title">func</span></span> ()
{
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"First version of func ()."</span>
}

<span class="hljs-function"><span class="hljs-title">func</span></span> ()
{
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"Second version of func ()."</span>
}

func   <span class="hljs-comment"># Second version of func ().</span>

<span class="hljs-built_in">exit</span> $?

<span class="hljs-comment">#  It is even possible to use functions to override</span>
<span class="hljs-comment">#+ or preempt system commands.</span>
<span class="hljs-comment">#  Of course, this is *not* advisable.</span></pre>
                </td>
              </tr>
            </tbody></table>
          </td>
        </tr>
      </tbody></table>
    </div>
  </div>
  <div class="NAVFOOTER">
    <hr align="left" width="100%">
    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <td width="33%" align="left" valign="top"><a href="process-sub.html" accesskey="P">Prev</a></td>
        <td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>
        <td width="33%" align="right" valign="top"><a href="complexfunct.html" accesskey="N">Next</a></td>
      </tr>
      <tr>
        <td width="33%" align="left" valign="top">Process Substitution</td>
        <td width="34%" align="center" valign="top"><a href="part5.html" accesskey="U">Up</a></td>
        <td width="33%" align="right" valign="top">Complex Functions and Function Complexities</td>
      </tr>
    </tbody></table>
  </div>


<button id="theme-toggle">Toggle theme</button></body></html>
